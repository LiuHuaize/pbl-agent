

### 1. 文档概述

#### 1.1 项目背景
项目式学习（PBL）能有效提升学生的核心素养，但对于一线教师而言，设计一门高质量的PBL课程面临巨大挑战：耗时耗力、缺乏经验、跨学科知识不足、资源搜集困难。本项目旨在开发一款由AI Agent驱动的PBL教学设计工具，通过人机协作的方式，赋能教师高效、轻松地创建出结构完整、内容丰富、符合教学实际的PBL项目方案。

#### 1.2 产品目标
*   **用户目标：**
    *   **降低门槛：** 帮助PBL新手教师快速上手，完成一个“及格线”以上的项目设计。
    *   **提升效率：** 将传统数天甚至数周的课程设计时间缩短至几小时内。
    *   **激发创意：** 作为教师的“智能副驾”，提供灵感、建议和备选方案，提升最终方案的质量与创意。
*   **产品目标：**
    *   打造一款行业领先的、深度结合教学法的AI教育工具。
    *   通过高度互动的“共创”体验，建立用户粘性与口碑。
    *   构建一个包含教学活动、工具卡、资源的可持续迭代的教育生态。

---

### 2. 用户画像与核心场景

#### 2.1 用户画像 (Persona)

*   **姓名：** 李老师
*   **角色：** 3-4年级小学语文老师，班主任
*   **PBL经验：** 初学者。听过讲座，尝试过一两次简单的活动，但从未独立设计过完整的PBL项目。
*   **痛点与担忧：**
    *   “想尝试PBL，但不知从何下手，感觉太复杂了。”
    *   “担心自己设计的活动流程不合理，课堂上控制不住场面。”
    *   “备课时间有限，没精力去查那么多跨学科的资料。”
    *   “最终的成果如何评价，怎么向学校和家长展示，心里没底。”
*   **期望：** 希望有一个工具能像一位经验丰富的导师，一步步引导她，提供具体的模板和资源，让她有信心把PBL项目落地。

#### 2.2 核心用户场景
李老师计划在期中围绕《长安的荔枝》这本书，为她的三年级学生设计一个为期两周的PBL项目。她打开了我们的“AI Agent辅助PBL教学设计工具”。

1.  **填写问卷：** 她首先看到了一个《PBL项目设计需求调研表》，并根据自己班级的情况（3-4年级、语文学科、希望AI推荐融合学科、6-8课时等）完整填写了问卷并提交。
2.  **共创主题：** 提交后，AI Agent立即分析了问卷，并向她提出了三个项目主题方向。李老师选择了“《唐代荔枝的奇幻之旅》”这个主题，并确认了Agent生成的核心任务和驱动性问题。
3.  **搭建教案：** 接下来，Agent引导她进入“交互式教学流程设计”环节。
    *   **启动阶段：** Agent推荐了“看视频”和“身临其境”两个活动，李老师觉得很合适，点击了确认。接着，Agent为这两个活动匹配了“KWL表格”和“共情雷达”两个工具卡，并展示了模板。李老师很满意。
    *   **探究阶段：** Agent又引导她设计探究阶段的活动，她根据Agent的建议，选择了“荔枝保鲜实验”、“古代交通工具研究”等活动，并为每个活动选择了合适的工具卡。
    *   整个过程就像在和一位教学专家对话，Agent一次只让她做一个小决策，让她感觉轻松且有掌控感。
4.  **匹配资源：** 教案框架搭建完毕后，Agent向她展示了一个分类整理好的资源库，里面有《过华清宫》的儿童版解读、唐代驿站的动画视频等。李老师预览后，勾选了几个需要的资源加入了项目包。
5.  **一键生成：** 最后，李老师点击“生成完整方案”。几秒钟后，一份格式精美、内容完整的PDF方案生成了，完全对标她之前看到过的《长安的荔枝》优秀范例。她还额外导出了一个只包含任务单的“学生学习包”，准备发给孩子们。

---

### 3. 产品功能需求 (Functional Requirements)

#### 3.1 模块一：项目启动与需求调研
*   **3.1.1 需求调研表单：**
    *   **描述：** 用户首次创建项目时，系统需呈现一份完整的、结构化的《PBL项目设计需求调研表》（参考附件《长安的荔枝》3-4年级.pdf中的调研表）。
    *   **功能点：**
        *   表单包含基础信息、教学条件、教师能力、学生情况、课程要求等模块。
        *   支持单选、多选、文本输入等多种填写方式。
        *   用户填写完毕后，可一键提交。此表单内容将作为后续所有AI生成的基础输入。

#### 3.2 模块二：核心主题与框架共创 (交互式)
*   **3.2.1 AI主题推荐：**
    *   **描述：** Agent在接收并分析调研表单后，需生成2-3个高度相关的项目主题提案供用户选择。
    *   **功能点：**
        *   每个提案应包含：项目名称、一句话简介、核心产出物、建议融合的学科。
        *   用户可以选择一个提案，或要求Agent根据其反馈进行微调（如：“我喜欢A，但能把重点放在解决问题上吗？”）。
*   **3.2.2 核心框架确认：**
    *   **描述：** 用户选定主题后，Agent需生成项目的**概述、核心任务、总驱动性问题**，并呈现给用户进行最终确认。
    *   **功能点：**
        *   生成的文本需清晰、简洁，符合对应年级段的认知水平。
        *   用户可对生成的文本进行在线编辑和修改。
        *   确认后的框架将成为整个项目方案的“总纲”。

#### 3.3 模块三：基于专业卡片体系的交互式教学流程设计 (核心交互模块)
*   **3.3.1 完整的PBL卡片体系集成：**
    *   **描述：** 系统需集成完整的157张专业PBL卡片体系，包括：
        *   **活动卡（A系列）**：57张卡片，涵盖启发、探究、实施、分享四个阶段
        *   **工具卡（B系列）**：63张卡片，包含基础工具、设计思维、实践管理三大类
        *   **合作卡（C系列）**：25张卡片，专注团队协作的组建、过程、评价
    *   **功能点：**
        *   每张卡片包含详细的使用说明、适用场景、配套关系等元数据
        *   支持按编号、分类、关键词等多维度检索卡片
        *   提供卡片预览和详细信息展示功能
        
*   **3.3.2 智能卡片匹配与推荐：**
    *   **描述：** 在每个设计步骤中，Agent需基于三类卡片的内在逻辑和关联关系进行智能推荐。
    *   **功能点：**
        1.  **阶段匹配：** 根据当前设计阶段（启动引入、知识探究、方案设计、项目实施、成果展示），自动筛选适用的活动卡
        2.  **智能推荐：** 基于用户需求、年级特点、学科属性等因素，从筛选的活动卡中推荐2-3个最优选择
        3.  **配套匹配：** 用户确认活动后，系统自动推荐配套的工具卡和合作卡，形成完整的教学组合
        4.  **关系图生成：** 为每个阶段生成"教学活动↔工具↔合作对照图"，如《长安的荔枝》案例所示
        
*   **3.3.3 专业化教学设计输出：**
    *   **描述：** 系统需为每个阶段生成符合专业标准的教学设计内容。
    *   **功能点：**
        *   **阶段目标：** 自动生成符合年级特点的具体学习目标
        *   **驱动问题：** 生成引导学生思考的核心问题
        *   **活动描述：** 详细的教学活动实施步骤和要点
        *   **工具模板：** 自动生成可直接使用的工具模板（如KWL表格、九宫格等）
        *   **合作指导：** 提供团队协作的具体指导方案
        *   **预期产出：** 明确每个阶段的学生产出物和评价标准
        
*   **3.3.4 实时预览与动态调整：**
    *   **描述：** 用户在中间交互区做的每一个选择和确认，都应立即在右侧的方案概要中以结构化文本的形式展现出来。
    *   **功能点：**
        *   实时显示已选择的卡片组合和生成的教学内容
        *   支持拖拽调整卡片组合和教学流程顺序
        *   提供一键替换功能，快速更换不合适的卡片
        *   用户可以随时点击右侧预览区的任何部分，返回到对应的设计步骤进行修改

#### 3.4 模块四：智能教学资源匹配 (交互式)
*   **3.4.1 资源智能推荐与检索：**
    *   **描述：** 在教学流程设计完成后，Agent需根据已确定的所有活动和知识点，自动从内置和外部资源库中检索并推荐相关教学资源。
    *   **功能点：**
        *   资源需自动分类（如：文学历史、音视频、科学常识、地图工具等）。
        *   每个资源应有标题、摘要和来源/链接。
        *   用户可以预览资源，并将其“收藏”到本项目的资源包中。
        *   提供搜索框，支持用户输入关键词进行二次、精细化检索。

#### 3.5 模块五：方案整合与导出
*   **3.5.1 最终方案预览：**
    *   **描述：** 用户完成所有设计步骤后，可进入“最终预览”模式，查看由所有分块内容无缝拼接而成的完整方案。
*   **3.5.2 基于《长安的荔枝》标准的专业化导出：**
    *   **描述：** 系统需支持将最终方案导出为符合《长安的荔枝》专业标准的多格式文件。
    *   **功能点：**
        *   **完整项目方案包 (PDF)：** 
            *   包含完整的需求调研表（已填写版本）
            *   项目概述和主题设计
            *   各阶段详细的项目活动设计
            *   教学活动↔工具↔合作对照图
            *   完整的工具模板集合（可直接打印使用）
            *   合作指导卡和实施建议
            *   专业的评价量规和反思表格
            *   教学资源清单和获取指导
            *   总页数约20-25页，与《长安的荔枝》案例格式完全一致
            
        *   **教师实施指导包 (PDF)：** 
            *   提取核心实施要点和注意事项
            *   包含常见问题解答和应对策略
            *   提供分课时的详细教学指导
            
        *   **学生学习材料包 (PDF)：** 
            *   仅包含学生需要的任务单和工具模板
            *   去除教师指导内容，适合直接分发
            *   包含学生版的评价表格和反思工具
            
        *   **数字化工具包：**
            *   导出所有工具卡的Word/Excel可编辑模板
            *   提供在线协作版本的链接（如腾讯文档、石墨文档等）
            *   包含项目管理用的检查清单和进度跟踪表

#### 3.6 模块六：个人项目中心
*   **3.6.1 项目管理：**
    *   **描述：** 用户可以保存、查看、复制和删除自己创建的所有PBL项目。
    *   **功能点：**
        *   为每个项目提供状态标记（如：设计中、已完成）。
        *   支持将已完成的项目作为模板，快速启动一个新项目。

---

### 4. 非功能性需求 (Non-Functional Requirements)

*   **4.1 性能：** AI Agent的单次响应时间（生成一段文字、推荐一个活动等）应在3-5秒内，保证交互的流畅性。PDF生成时间应在10秒内。
*   **4.2 可用性：** 界面设计简洁、直观，引导清晰。即使是首次使用的教师也能在无指导的情况下完成基本操作。
*   **4.3 可靠性：** 用户的设计进度需能自动保存，防止因意外关闭浏览器等造成数据丢失。系统需保证99.9%的可用性。
*   **4.4 可扩展性：** 系统的【教学活动卡】、【工具卡】、【合作卡】应设计为可配置的数据库模块，方便未来不断扩充和更新，而无需修改核心代码。

---

### 5. 技术实现概要

*   **5.1 核心架构：** 前后端分离架构。
*   **5.2 LLM调用策略（关键）：**
    *   **分块生成：** 严格遵循“分块生成，后端组装”的原则。LLM的每次调用只负责生成一个小的、独立的文本块（如一个活动的描述、一个工具的介绍），输出格式为Markdown或JSON。
    *   **动态项目蓝图：** 后端维护一个结构化的JSON对象（项目蓝图），用于存储用户在每一步交互中确认的内容。LLM生成的文本块被填充到这个JSON对象的相应字段中。
*   **5.3 PDF生成方案：**
    *   后端使用**模板引擎**（如Jinja2）和一个预设的**HTML/CSS模板**。
    *   当用户请求导出时，后端将“项目蓝图”中的数据渲染进HTML模板，然后调用PDF生成库（如WeasyPrint, Puppeteer）将渲染后的HTML页面转换为PDF文件。

---

### 6. 未来迭代方向

*   **V1.1：** 引入更多学科（如数学、艺术）的专属活动卡和工具卡。
*   **V1.2：** 增加“学生评价”模块，帮助教师生成和管理过程性评价量规。
*   **V2.0：** 建立教师社区，用户可以分享、借鉴和评论彼此的PBL项目方案，形成优质内容生态。

---

### 7. AI Agent工作流程架构

#### 7.1 整体架构概述
本系统采用四阶段AI Agent工作流程，通过结构化的交互式设计，引导用户从需求调研到最终方案生成的完整PBL教学设计过程。

#### 7.2 四个核心阶段 (Part One - Part Four)

##### Part One: 需求调研阶段 (Requirements Research)
**目标：** 收集用户基础信息和教学需求
- **输入：** 用户填写完整的PBL项目设计需求调研表
- **处理流程：**
  - 基础信息收集
  - 教学条件分析
  - 学生情况评估
  - 课程要求确认
- **输出：** 结构化的用户需求数据，为后续阶段提供基础输入

##### Part Two: 主题设计阶段 (Theme Design)
**目标：** 生成和确认项目核心主题框架
- **输入：** Part One的需求调研数据
- **处理流程：**
  - 生成项目主题建议 → 用户确认或修改
  - 生成核心任务描述 → 用户确认或修改
  - 生成驱动性问题 → 用户确认或修改
  - 生成教学目标和评价标准 → 用户确认或修改
- **输出：** 确认的项目主题、核心任务、驱动性问题和评价框架

##### Part Three: 教学流程设计阶段 (Teaching Process Design)
**目标：** 构建详细的教学活动流程
- **输入：** Part Two确认的主题框架
- **处理流程：**
  - 生成教学活动建议 → 用户确认或修改
  - 生成配套工具卡建议 → 用户确认或修改
  - 生成教学步骤详细描述 → 用户确认或修改
- **输出：** 完整的教学活动流程和配套工具

##### Part Four: 资源匹配与方案生成阶段 (Resource Matching & Solution Generation)
**目标：** 匹配教学资源并生成最终方案
- **输入：** Part Three的教学流程设计
- **处理流程：**
  - 智能推荐教学资源 → 用户选择确认
  - 生成完整教学方案
  - 生成学生学习包
- **输出：** 完整的PBL教学方案文档和学生材料包

#### 7.3 交互式设计原则

##### 7.3.1 分步确认机制
- 每个阶段的每个步骤都需要用户明确确认才能进入下一步
- 用户可以随时返回上一步进行修改
- 系统保存每一步的用户选择，支持断点续传

##### 7.3.2 智能推荐与用户选择
- AI Agent基于前序信息提供2-3个推荐选项
- 用户可以选择推荐选项、要求修改或提供自定义输入
- 系统根据用户反馈动态调整后续推荐

##### 7.3.3 实时预览与反馈
- 右侧实时显示当前方案构建进度
- 用户可以预览每个阶段的输出效果
- 支持在预览中直接跳转到对应编辑步骤

#### 7.4 数据流转架构

```
用户输入 → AI分析处理 → 生成推荐选项 → 用户确认选择 → 更新方案数据 → 进入下一步骤
    ↑                                                                    ↓
    ←←←←←←←←←←←←← 用户可随时返回修改 ←←←←←←←←←←←←←←←←←←←←←←←←←←←←←←←
```

#### 7.5 技术实现要点

##### 7.5.1 状态管理
- 维护全局项目状态对象，记录每个阶段的用户选择
- 支持状态的序列化存储和恢复
- 实现版本控制，支持撤销和重做操作

##### 7.5.2 AI调用策略
- 采用分块生成策略，每次AI调用只处理单一、明确的任务
- 基于用户历史选择和当前上下文进行智能推荐
- 实现推荐结果的多样性和相关性平衡

##### 7.5.3 用户体验优化
- 采用渐进式信息披露，避免用户认知负荷过重
- 提供清晰的进度指示和导航
- 支持快速预览和一键回退功能

#### 7.6 质量保证机制

##### 7.6.1 内容一致性检查
- 确保各阶段生成内容的逻辑一致性
- 验证教学目标与活动设计的匹配度
- 检查资源推荐与教学需求的相关性

##### 7.6.2 用户体验监控
- 记录用户在各阶段的停留时间和操作路径
- 监控用户的修改频率和满意度反馈
- 基于使用数据持续优化推荐算法

这个架构确保了AI Agent能够以结构化、可控的方式引导用户完成复杂的PBL教学设计任务，同时保持高度的交互性和用户自主性。

---

### 8. 基于《长安的荔枝》标准的产品升级说明

#### 8.1 专业化升级要点

**卡片体系深度集成：**
- 完整集成157张专业PBL卡片（活动卡A系列57张 + 工具卡B系列63张 + 合作卡C系列25张）
- 实现基于卡片编号和关联关系的智能匹配推荐算法
- 自动生成"教学活动↔工具↔合作对照图"，如《长安的荔枝》案例所示

**输出格式专业化：**
- 完全对标《长安的荔枝》3-4年级.pdf的文档结构和格式标准
- 包含完整的需求调研表、项目概述、各阶段详细设计、工具模板集合等
- 支持多层次导出：完整方案包、教师指导包、学生材料包、数字化工具包

**AI能力增强：**
- 采用Gemini-2.5-Pro作为统一大模型，充分利用2M token长上下文窗口
- 实现跨四个阶段的完整上下文保持和智能决策
- 基于专业PBL教学法的深度定制化Prompt工程

#### 8.2 用户体验提升

**专业性提升：**
- 生成的教学方案完全符合《长安的荔枝》的专业标准
- 提供可直接使用的工具模板和评价量规
- 确保卡片组合的教学逻辑性和实施可行性

**便利性增强：**
- 智能卡片推荐减少用户选择负担
- 自动生成配套的工具和合作指导
- 一键导出多种格式的实用文档

**可靠性保障：**
- 基于成熟的PBL卡片体系，确保教学设计的科学性
- 长上下文管理保证四阶段设计的连贯性
- 专业模板确保输出质量的一致性

这一升级使产品真正达到了《长安的荔枝》案例的专业水准，能够为教师提供完整、可用、高质量的PBL教学方案。